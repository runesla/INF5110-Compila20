<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-02-03 Mon 14:24 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="INF5110, spring 2020" />
<meta name="description" content="Compila 20 language specification"
 />
<style dataType="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" dataType="text/css" href="compilastyle.css" />
<h1> Compila 20 language specification</h1>
<script dataType="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org9f5d94c">1. Introduction</a>
<ul>
<li><a href="#org92b0336">1.1. Notational conventions and syntax of this document</a></li>
</ul>
</li>
<li><a href="#org4571263">2. Lexical aspects</a>
<ul>
<li><a href="#org3a5447e">2.1. Identifiers and literals</a></li>
<li><a href="#org21aac3a">2.2. Comments</a></li>
</ul>
</li>
<li><a href="#orga16ef04">3. Data types</a>
<ul>
<li><a href="#org48d4cc6">3.1. Built in data types</a></li>
<li><a href="#org5b74281">3.2. Records</a></li>
<li><a href="#orge61e8b2">3.3. References</a></li>
</ul>
</li>
<li><a href="#org022cab8">4. Syntax</a>
<ul>
<li><a href="#orgd146b88">4.1. Grammar</a></li>
<li><a href="#org64be325">4.2. Precedence</a></li>
<li><a href="#orgde83e01">4.3. Associativity</a></li>
</ul>
</li>
<li><a href="#orgf932981">5. Parameter passing</a>
<ul>
<li><a href="#org1c8ec6e">5.1. Call-by-value</a></li>
<li><a href="#org91f541c">5.2. Small example for call-by-reference</a></li>
</ul>
</li>
<li><a href="#orged7fba3">6. Standard library</a></li>
<li><a href="#org27bd49a">7. Static semantics / typing / evaluation.</a>
<ul>
<li><a href="#org7a400fa">7.1. Binding of names</a></li>
<li><a href="#org5bda77e">7.2. Typing of compound constructs</a></li>
<li><a href="#orgb891ed6">7.3. Types and implicit dataType conversion</a></li>
<li><a href="#orgf1ae80d">7.4. Type inference</a></li>
<li><a href="#org718d4b2">7.5. Short-circuit evaluation</a></li>
</ul>
</li>
<li><a href="#org778f37e">8. Procedures</a></li>
<li><a href="#orgef9acf0">9. Further conditions</a></li>
</ul>
</div>
</div>


<div id="outline-container-org9f5d94c" class="outline-2">
<h2 id="org9f5d94c"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
This document specifies and describes the syntax and the static semantics
of the language <i>Compila 20</i>.  The dynamic semantics, i.e., the description
of the language's behavior when being executed, should be fairly clear even
without explicit formal specification. 
</p>
</div>





<div id="outline-container-org92b0336" class="outline-3">
<h3 id="org92b0336"><span class="section-number-3">1.1</span> Notational conventions and syntax of this document</h3>
<div class="outline-text-3" id="text-1-1">
<p>
In the description of the grammar later, we use capital letters for
non-terminals. As <i>meta-symbols</i> for the grammar, we use the following:
</p>


<pre class="example">
-&gt;,  |,  (,  ), {,  },  [,  ], "  
</pre>

<p>
Commas in the previous line are used as ``meta-meta symbols'' in the
enumeration of the meta-symbols.
</p>



<p>
When writing down the grammar in some variant of EBNF, <code>{...}</code> represents
iteration of zero or more times, <code>[...]</code> represents <i>optional</i>
clauses. Everything else, written as contiguous sequences, are <i>terminal
symbols</i>. Those with only <i>small</i> letters are reserved <i>keywords</i> of the
meta-language.
</p>

<p>
Note that terminal symbols of the Compila-language are written in
``string-quotes'' (i.e., with a <code>"</code> at the beginning and at the end) to
distinguish them from symbols from the meta-language. Some <i>specific</i>
terminal symbols are written in capitals, and <i>without</i> quotes.  Those are
</p>
<ul class="org-ul">
<li><code>NAME</code>,</li>
<li><code>INT_LITERAL</code>,</li>
<li><code>FLOAT_LITERAL</code> and</li>
<li><code>STRING_LITERAL</code>.</li>
</ul>

<p>
See the following section about lexical aspects for what those terminal
symbols represent.
</p>
</div>
</div>
</div>

<div id="outline-container-org4571263" class="outline-2">
<h2 id="org4571263"><span class="section-number-2">2</span> Lexical aspects</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org3a5447e" class="outline-3">
<h3 id="org3a5447e"><span class="section-number-3">2.1</span> Identifiers and literals</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li><code>NAME</code> must start with a letter, followed by a (possibly empty) sequence
of numeric characters, letters, and underscore characters; the
underscore is not allowed to occur at the end. Capital and small letters
are considered different.</li>

<li>All <i>keywords</i> of the languages are written in with lower-case
letters. Keyword <i>cannot</i> be used for standard identifiers.</li>

<li><code>INT_LITERAL</code> contains one or more numeric characters.</li>

<li><code>FLOAT_LITERAL</code> contains one or more numeric characters, followed by a
decimal point sign, which is followed by one or more numeric characters.</li>

<li><code>STRING_LITERAL</code> consists of a string of characters, enclosed in
quotation marks (<code>"</code>).  The string is not allowed to contain line shift,
new-line, carriage return, or similar. The semantic <i>value</i> of a
<code>STRING_LITERAL</code> is only the string itself, the quotation marks are not
part of the string value itself.</li>
</ul>
</div>
</div>


<div id="outline-container-org21aac3a" class="outline-3">
<h3 id="org21aac3a"><span class="section-number-3">2.2</span> Comments</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Compila supports <i>single line</i> and <i>multi-line</i> comments.
</p>


<ol class="org-ol">
<li>Single-line comments start with <code>//</code> and the comment extends until the
end of that line (as in, for instance, Java, C++, and most modern
C-dialects).</li>
<li>Multi-line comments start with <code>(*</code> and end with <code>*)</code>.</li>
</ol>

<p>
The latter form cannot be nested. The first one is allowed to be ``nested''
(in the sense that a commented out line can contain another <code>//</code> or the
multi-line comment delimiters, which are then ignored).
</p>
</div>
</div>
</div>

<div id="outline-container-orga16ef04" class="outline-2">
<h2 id="orga16ef04"><span class="section-number-2">3</span> Data types</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org48d4cc6" class="outline-3">
<h3 id="org48d4cc6"><span class="section-number-3">3.1</span> Built in data types</h3>
<div class="outline-text-3" id="text-3-1">
<p>
The language has four built-in types and user-defined types:
</p>

<ul class="org-ul">
<li><i>Built-in types</i> 
<ol class="org-ol">
<li>floating point numbers (<code>"float"</code>),</li>
<li>integers (<code>"int"</code>),</li>
<li>strings  (<code>"string"</code>), and</li>
<li>booleans (<code>"bool"</code>).</li>
</ol></li>

<li><i>User-defined</i> types: 
<ol class="org-ol">
<li>Each (name of a) record represents a dataType.</li>
<li>Reference types, representing references to elements 
of the specified types. The reference dataType constructor
can be nested.</li>
</ol></li>
</ul>
</div>
</div>


<div id="outline-container-org5b74281" class="outline-3">
<h3 id="org5b74281"><span class="section-number-3">3.2</span> Records</h3>
<div class="outline-text-3" id="text-3-2">
<p>
The language supports records. For people coming from Java/C++ etc.,
records can be seen as (very) simple form of classes, containing only
instance variables as members, but support neither <i>methods</i> nor
<i>inheritance</i> nor explicitly programmable <i>constructors</i>. ``Instance
variables'' are more commonly called record fields or just <i>fields</i> when
dealing with records. Records do support <i>instantiation</i>, here via the
<code>new</code> keyword. Another aspect which resembles classes as in Java is that
variables of record dataType contains either a pointer to an element
(``object'') of that record dataType or the special pointer value
<code>null</code>.<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>
</p>
</div>
</div>

<div id="outline-container-orge61e8b2" class="outline-3">
<h3 id="orge61e8b2"><span class="section-number-3">3.3</span> References</h3>
<div class="outline-text-3" id="text-3-3">
<p>
The language allows that variables can be declared to be of reference dataType
("pointers", if you will) by writing, e.g., 
</p>


<div class="org-src-container">
<pre class="src src-compila">var x: ref(int);
</pre>
</div>


<p>
Variables,  like <code>x</code>,  can be assigned values that are references, so, e.g.,
the following is allowed:
</p>

<div class="org-src-container">
<pre class="src src-compila">var y: int;
y := 42;
x := ref(y);
</pre>
</div>

<p>
Correspondingly, one can ``follow'' a reference <code>r</code> by using <code>deref(r)</code>, so
that, given the previous definitions, the following is legal:
</p>

<div class="org-src-container">
<pre class="src src-compila">y := deref(x);
</pre>
</div>

<p>
Expressions with <code>deref</code> can also be used as L-values, so that we can
assign values to the location that they are pointing to, e.g.:
</p>


<div class="org-src-container">
<pre class="src src-compila">deref(x) := y;
</pre>
</div>


<p>
See also later the swap procedure example later in the context of parameter
passing.
</p>
</div>
</div>
</div>





<div id="outline-container-org022cab8" class="outline-2">
<h2 id="org022cab8"><span class="section-number-2">4</span> Syntax</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-orgd146b88" class="outline-3">
<h3 id="orgd146b88"><span class="section-number-3">4.1</span> Grammar</h3>
<div class="outline-text-3" id="text-4-1">
<p>
The following productions in EBNF describe the syntax of the language.  For
precedences and associativity of various constructs, see later.
</p>



<div class="org-src-container">
<pre class="src src-compila">PROGRAM            -&gt; "program" NAME "begin" [ DECL {";" DECL}]  "end"

DECL               -&gt; VAR_DECL | PROC_DECL | REC_DECL

VAR_DECL           -&gt; "var" NAME ":" TYPE [ ":=" EXP ] |  "var" NAME ":="  EXP 

PROC_DECL          -&gt; "procedure" NAME 
		      "(" [ PARAMFIELD_DECL { "," PARAMFIELD_DECL } ] ")"
		      [ ":" TYPE ]
		      "begin" [[DECL{";" DECL}] "in"] STMT_LIST "end"
REC_DECL           -&gt; "struct" NAME "{" [ PARAMFIELD_DECL 
					  {";" PARAMFIELD_DECL }]  "}"
PARAMFIELD_DECL     -&gt; NAME ":" TYPE


STMT_LIST          -&gt; [STMT {";" STMT}]


EXP                -&gt; EXP LOG_OP EXP
		    | "not" EXP
		    | EXP REL_OP EXP
		    | EXP ARITH_OP EXP
		    | LITERAL
		    | CALL_STMT
		    | "new" NAME
		    | VAR
		    | REF_VAR
		    | DEREF_VAR
		    | "(" EXP ")"

REF_VAR            -&gt; "ref" "(" VAR ")"
DEREF_VAR          -&gt; "deref" "(" VAR ")" | "deref" "(" DEREF_VAR ")"

VAR                -&gt; NAME | EXP "." NAME

LOG_OP             -&gt; "&amp;&amp;" | "||"

REL_OP             -&gt; "&lt;" | "&lt;=" | "&gt;" | "&gt;=" | "=" | "&lt;&gt;"

ARITH_OP           -&gt; "+" | "-" | "*" | "/" | "^"

LITERAL            -&gt; FLOAT_LITERAL | INT_LITERAL 
		    | STRING_LITERAL | BOOL_LITERAL | "null"

BOOL_LITERAL       -&gt;  "true" | "false" 

STMT               -&gt; ASSIGN_STMT
		    | IF_STMT
		    | WHILE_STMT
		    | RETURN_STMT
		    | CALL_STMT

ASSIGN_STMT        -&gt; VAR ":=" EXP | DEREF_VAR ":=" EXP

IF_STMT            -&gt; "if" EXP "then" { STMT_LIST } 
		       [ "else"  { STMT_LIST } ] "fi" 
WHILE_STMT         -&gt; "while" EXP "do"  { STMT_LIST  } "od"

RETURN_STMT        -&gt; "return" [ EXP ]

CALL_STMT          -&gt; NAME "(" [ EXP { "," EXP } ] ")"

TYPE               -&gt; "float" | "int" | "string" | "bool" | NAME
		    | "ref" "(" TYPE ")"
</pre>
</div>
</div>
</div>


<div id="outline-container-org64be325" class="outline-3">
<h3 id="org64be325"><span class="section-number-3">4.2</span> Precedence</h3>
<div class="outline-text-3" id="text-4-2">
<p>
The precedence of the following constructs is ordered as follows (from
lowest precedence to the highest):
</p>

<ol class="org-ol">
<li><code>||</code></li>
<li><code>&amp;&amp;</code></li>
<li><code>not</code></li>
<li>All relational symbols</li>
<li><code>+</code> and <code>-</code></li>
<li><code>*</code> and <code>/</code></li>
<li><code>^</code> (exponentiation)</li>
<li><code>.</code> (``dot'', to access fields of a record)</li>
</ol>
</div>
</div>

<div id="outline-container-orgde83e01" class="outline-3">
<h3 id="orgde83e01"><span class="section-number-3">4.3</span> Associativity</h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li>The binary operations <code>||</code>, <code>&amp;&amp;</code>, <code>+</code>, <code>-</code>, <code>*</code>, and <code>.</code> are
<i>left-associative</i>, but exponentiation <code>^</code> is right-associative.</li>

<li>Relation symbols are non-associative. That means that for instance <code>a &lt; b + c &lt; d</code> is illegal.</li>

<li>It's legal to write <code>not not not b</code> and it stands for <code>(not (not (not b)))</code>.</li>
</ul>
</div>
</div>
</div>



<div id="outline-container-orgf932981" class="outline-2">
<h2 id="orgf932981"><span class="section-number-2">5</span> Parameter passing</h2>
<div class="outline-text-2" id="text-5">
<p>
When describing the parameter passing mechanisms of the language, this
document distinguishes (as is commonly done) between
</p>

<ul class="org-ul">
<li><i>actual</i> parameters and</li>
<li><i>formal</i> parameters.</li>
</ul>


<p>
The actual parameters are the expressions (which include among other things
variables) as part of a procedure <i>call</i>. The formal parameters are the
variables mentioned as part of procedure <i>definition</i>. The language
supports supports as only parameter passing mechanism call-by-value:
</p>
</div>

<div id="outline-container-org1c8ec6e" class="outline-3">
<h3 id="org1c8ec6e"><span class="section-number-3">5.1</span> Call-by-value</h3>
<div class="outline-text-3" id="text-5-1">
<p>
The formal parameters are <i>local</i> variables in the procedure
definition. When a procedure is being called, the <i>values</i> of the local
parameters are <i>copied</i> into the corresponding formal parameters.<sup><a id="fnr.2" class="footref" href="#fn.2">2</a></sup>
</p>
</div>
</div>


<div id="outline-container-org91f541c" class="outline-3">
<h3 id="org91f541c"><span class="section-number-3">5.2</span> Small example for call-by-reference</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">
<pre class="src src-compila">program swapexample
  begin
    procedure swap (a :  ref(int), b : ref(int)) 
    begin
      var tmp : int
    in
      tmp      := deref(a);
      deref(a) := deref(b);
      deref(b) := tmp
    end;
    procedure main ( ) 
      begin
	var x : int;
	var y : int; 
	var xr : ref (int);
	var yr : ref (int)
       in
	x := 42; y := 84;
	xr := ref (x); yr := ref(y);
	swap (xr,yr)
      end
  end
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orged7fba3" class="outline-2">
<h2 id="orged7fba3"><span class="section-number-2">6</span> Standard library</h2>
<div class="outline-text-2" id="text-6">
<p>
The programming language comes with a standard library which offers a
number of IO-procedures. All reading, i.e., input, is done from standard
input (``stdin''). All writing, i.e., output, is to standard output
(``stdout'')
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>proc readint(): int</code></td>
<td class="org-left">read one integer</td>
</tr>

<tr>
<td class="org-left"><code>proc readfloat(): float</code></td>
<td class="org-left">read one float</td>
</tr>

<tr>
<td class="org-left"><code>proc readchar(): int</code></td>
<td class="org-left">read one character and return its ASCII value. Return <code>-1</code> for <code>EOF</code></td>
</tr>

<tr>
<td class="org-left"><code>proc readstring(): string</code></td>
<td class="org-left">read a string (until  first whitespace</td>
</tr>

<tr>
<td class="org-left"><code>proc readline(): string</code></td>
<td class="org-left">read one line</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><code>proc printint(i:int)</code></td>
<td class="org-left">write an integer</td>
</tr>

<tr>
<td class="org-left"><code>proc printfloat(f:float)</code></td>
<td class="org-left">write one floating point number</td>
</tr>

<tr>
<td class="org-left"><code>proc printstr(s:string)</code></td>
<td class="org-left">write one string</td>
</tr>

<tr>
<td class="org-left"><code>proc printline(s:string)</code></td>
<td class="org-left">write one string, followed by a ``newline''</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>


<div id="outline-container-org27bd49a" class="outline-2">
<h2 id="org27bd49a"><span class="section-number-2">7</span> Static semantics / typing / evaluation.</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org7a400fa" class="outline-3">
<h3 id="org7a400fa"><span class="section-number-3">7.1</span> Binding of names</h3>
<div class="outline-text-3" id="text-7-1">
<p>
The using occurence of an identifier (without a preceding dot) is bound in
the common way to a <i>declaration</i>. This association of the use of an
identifier to a declaration (``binding'') can be described informally as
follows: Look through the block or scope which encloses the use-occurence
of the identifer (where the block refers to the procedure body or
program). The binding occurrence corresponding to the use occurence is the
<i>first</i> declaration found in this way.  If no binding occurence is found
that way, the program is <i>erroneous</i>. Formal parameters count as
declarations local to the procedure body.
</p>

<p>
Use occurences of a name preceded  by a dot correspond to the clause <code>EXP
"." NAME</code> in the production for the non-terminal <code>VAR</code> in the grammar.
Those names are bound by looking at the dataType of <code>EXP</code> (which is required to
be a record-dataType) and look up the field with name <code>NAME</code> in that record. It's
an common.error, if <code>EXP</code> is not of record-dataType or else, there is not such field in
that record,
</p>
</div>
</div>


<div id="outline-container-org5bda77e" class="outline-3">
<h3 id="org5bda77e"><span class="section-number-3">7.2</span> Typing of compound constructs</h3>
<div class="outline-text-3" id="text-7-2">
<ul class="org-ul">
<li><b>expressions:</b> expressions need to be checked for dataType correctness in the
obvious manner. The whole expression (if it dataType-checks) will thus
carry a dataType.</li>
<li><b>assignments:</b> Both sides of an assignment must be of the same dataType.
Note: it is allowed to assign to the formal parameters of a
procedure. That applies to both call-by-value and call-by-reference
parameters. Of course, the effect of an assignment in these two
mechanisms is different.</li>
<li><b>conditionals and while loop:</b> the condition (i.e., expression) in the
conditional construct must be of dataType <code>bool</code>. Same for the condition in
the while loop.</li>
<li><b>field selection:</b>
<ul class="org-ul">
<li>the expression standing in front of a dot must be of record dataType.</li>
<li>the name standing after a dot are the name of a field/attribute of the
record dataType of the expression in front of the dot. The dataType of the field
selection expression (if it dataType checks) is the dataType as declared for
the field of the record.</li>
</ul></li>
</ul>
</div>
</div>


<div id="outline-container-orgb891ed6" class="outline-3">
<h3 id="orgb891ed6"><span class="section-number-3">7.3</span> Types and implicit dataType conversion</h3>
<div class="outline-text-3" id="text-7-3">
<p>
It is allowed to assign an expression of dataType <code>int</code> to a variable of dataType
<code>float</code>. The inverse situation is not allowed. There is no dataType cast
operator. If an <i>arithmetic</i> expression has at least one operand of dataType
<code>float</code>, the operation is evaluated using floating point arithmetic and the
result is of dataType <code>float</code>. Exponentiation is <i>always</i> considered done with
floating point arithmetic and the result is of dataType <code>float</code>.
</p>
</div>
</div>


<div id="outline-container-orgf1ae80d" class="outline-3">
<h3 id="orgf1ae80d"><span class="section-number-3">7.4</span> Type inference</h3>
<div class="outline-text-3" id="text-7-4">
<p>
The language requires a tiny bit of dataType inference (so small that one might
not even call dataType inference).  <i>Variables</i> need to be declared, using the
keyword <code>var</code>. In particular, variables must have a dataType at the point when
they are declared. The declaration can be combined with a definition of an
initial value of introduced variable (using the syntax like <code>var x : int :=
42</code>). When provided with an initial expression, the dataType can be omitted
(using a syntax like <code>var x := 42</code>), in which case an appropriate dataType
needs to be inferred.
</p>
</div>
</div>

<div id="outline-container-org718d4b2" class="outline-3">
<h3 id="org718d4b2"><span class="section-number-3">7.5</span> Short-circuit evaluation</h3>
<div class="outline-text-3" id="text-7-5">
<p>
The logical operators <code>&amp;&amp;</code> and <code>||</code> use so-called <i>short-circuit
evaluation</i>. That means that <i>if</i> the value of the logical expression can
be determined after one has evaluated the <i>first part, only</i>, the rest of
the expression is <i>not</i> evaluated.
</p>
</div>
</div>
</div>

<div id="outline-container-org778f37e" class="outline-2">
<h2 id="org778f37e"><span class="section-number-2">8</span> Procedures</h2>
<div class="outline-text-2" id="text-8">
<ul class="org-ul">
<li>In a procedure, all declarations are required to occur <i>before</i>
executable code (statements).  In a procedure, the <i>same</i> declarations
are allowed as on the outermost, global scope, i.e., procedure-local
declarations of variables, procedures, and records are allowed.</li>
<li>Procedures called within an expression <i>must</i> have a defined return
dataType. That dataType must match with the way the call is <i>used</i> in an
expression.</li>
<li>Concerning the number and types of the parameters of a procedure: they
must coincide comparing the declaration/definition of the procedure and
the use of a procedure. That requirement applies also to the parameter
passing mechanism (i.e., whether the variable resp. actual parameter is
marked as ``by <code>ref</code>''.</li>
<li><p>
Return statements:
</p>
<ul class="org-ul">
<li>A <code>return</code>-statment is allowed only in procedure-definitions. Such a
statement marks that the procedure terminates (and returns). In
addition, the return statement gives an expression for the value to be
returned to the caller.</li>
<li>If a procedure is declared without return dataType, the procedure does not
<i>need</i> a return statement. In that case, the procedure returns
(without a return value) when the last statement in the procedure body
has been  executed.</li>
</ul>
<ul class="org-ul">
<li>If a procedure has declared a return dataType, its body is required to have
a return statement (with corresponding expression of the correct
dataType). That statement need to be the last statement in the procedure's
body.</li>
</ul></li>
</ul>
</div>
</div>




<div id="outline-container-orgef9acf0" class="outline-2">
<h2 id="orgef9acf0"><span class="section-number-2">9</span> Further conditions</h2>
<div class="outline-text-2" id="text-9">
<ul class="org-ul">
<li>Declarations must be <i>unique</i> per block. Two declarations (within one
block) of a procedure, a record, or a variable with the same name are
considered as double declarations, which are <i>forbidden</i>.</li>
<li>The name of a formal parameter must not collide with names of local
declarations within the procedure. Besides, the names of all formal
parameters of one procedure must by distinct.</li>
<li>All names being used must be declared.</li>
<li>Each program must have a procedure named <code>main</code>. This procedure is the one
called upon start of the program.</li>
</ul>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
Records are sometimes also called ``structs''.
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2">2</a></sup> <div class="footpara"><p class="footpara">
The language supports reference types. Variables or expressions of
reference dataType are passed <i>by value</i>. That leads to a behavior resembling
pretty much ``call-by-reference'', but the parameter passing mechanism
proper <i>is</i> call-by-value (of reference data). One may speak of
call-by-value-reference.
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: INF5110, spring 2020</p>
<p class="date">Created: 2020-02-03 Mon 14:24</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>